## 1. Начинаем
Загружаю в wireshark, ничего непонятно, с стартуем с каких-то запросов с 192.168.8.223, поэтому проверим не наш ли это основной сетевой интерфейс c помощью фильтра:

ip.src != 192.168.8.223 and ip.dst != 192.168.8.223

Отлично: 192.168.8.223 наш IP

## 2. Понимаем куда ходили
Пишем простой питонячий скрипт, чтобы посмотреть что у нас вообще в сети (начнем с TCP):
![alt text](ip.png "Сеть")
![alt text](ports.png "TCP Ports")
## 3. Отлично, то есть получаем:
* 155.212.242.132:443 - это наш VPN;

* 216.239.36.131:5223 - немного утелки (какие-то пуши, судя по порту)

* 192.168.8.102:7000;192.168.4.61:7000 - что-то в локальной сети, разумно, что траффик и не должен через VPN идти;
## 4. Теперь посмотрим на UDP
![alt text](graph_udp_dns.png "UDP")
Выглядит страшно, но тут видим, что очень много идет в наш VPN, смотрим что пошло мимо:
* 91.108.0.0\16 - это Telegram, и он идет мимо VPN

* 224.0.0.251 - DNS (локальный DNS, а почему не через VPN тоже?)
Проверяем в wireshark что спрашивали: _ws.col.protocol == MDNS

	Спрашивали:

	- googlecast

	- spotify-connect

* 239.255.255.250:1900 - девайсы в локальной сети

* 77.125.38.24:49273 - тут ошибка NXDOMAIN, непонятно что за IP

* 157.240.196.62:3478 - dig говорит, что edgeray-shv-02-mrs2.facebook.com (ага, фейсбук, значит whatsapp, 3478 port - WhatsApp send Call)

## 5. Итак, выявленные утечки:
- Tелеграмный UDP идет мимо;
- Немного DNSа пошло в локальный DNS;
- Whatsapp Send Call идет мимо;

## 6. Как зачинить?

Надо смотреть в 2 местах:

1. Как мы раутим траффик в TUN:
```bash
ip route show
```
2. И непосредственно код VPN, по какой логике он решает что и куда пускать.